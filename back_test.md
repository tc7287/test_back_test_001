📄 일봉 기반 전략 백테스트 프로세스 정리 (Markdown)
# 1. 개요

본 문서는 일봉(OHLCV) 데이터를 기반으로 한 퀀트 전략 백테스트 전체 프로세스를 정의한다.
백테스트는 총 6단계(In-sample, Out-of-sample, Forward Test 포함)로 구성되며,
각 단계는 전략 성능 검증과 실전 운용 가능성을 평가하기 위한 목적을 가진다.

전략은 **신호(logic)**만 정의하며,
계좌 리스크 관리 및 포지션 사이징은 전략과 분리된 RiskManager가 담당한다.

# 2. 전체 백테스트 단계 요약
1. 전략 정의
2. In-sample 백테스트 (전략 개발)
3. Out-of-sample 백테스트 (일반화 성능 검증)
4. Forward Test (실전 모의고사)

# 3. 단계별 상세 설명
## 3.1 전략 정의 (Strategy Definition)
목적

전략이 어떤 패턴을 기반으로 매수/매도할지 정의하는 단계

종목을 직접 선택하는 것이 아니라 **신호(Logical Condition)**을 정의한다

구성 요소

매수 조건 (예시 : 변동성돌파전략)
매도 조건
손절/익절 규칙 (예: -10%, +20%)
신호 강도(Optional)
전략 대상 유니버스(예: KOSPI 시총 상위 50개 종목)

특징

타임프레임: 일봉만 사용

전략은 계좌 상태를 알지 못함 (리스크 제어는 RiskManager 담당)

## 3.2 In-sample 백테스트 (IS)
목적

전략 자체의 순수한 수익성(알파)을 검증

파라미터 튜닝은 이 구간에서만 수행

전략이 과거 시장에서 의미 있는 패턴을 포착하는지 평가

테스트 방식

고정 비중 또는 단위 수량으로 테스트 (RiskManager 적용 ❌)

유니버스 전체 종목에 대해 모든 신호를 백테스트

Trade(매수→매도 한 쌍) 단위로 승률·손익비 평가

NAV(Time-series)를 통해 Sharpe, CAGR, MDD 평가

통과 기준 (예시 : 변동성돌파전략)

Sharpe > 1.0

MDD < 25%

CAGR > 10%

Win Rate > 50% 또는 기대값(Expectancy) > 0

특정 종목에 성과가 과도하게 집중되지 않을 것

요약

✔ 전략이 “과거 패턴 기반으로 먹히는 전략인지” 확인하는 단계
✔ 계좌 리스크 제약 없음
✔ 전략이 튜닝되는 구간

## 3.3 Out-of-sample 백테스트 (OOS)
목적

In-sample에서 설계된 전략이 과적합인지 여부 확인

새로운 데이터에서도 성능 유지되는지 검증

테스트 방식

In-sample에서 찾은 파라미터 그대로 사용 (재튜닝 금지)

계좌 제약 없이 전략 순수 성능 검증 (기본)

또는 RiskManager 일부 적용 (선택 사항)

통과 기준

IS와 성능 패턴이 크게 다르지 않을 것

Equity curve가 자연스럽게 이어질 것

Sharpe, MDD, 승률, 손익비가 급격히 훼손되지 않을 것

요약

✔ IS에서 찾은 전략이 “과적합이 아닌지” 확인
✔ 전략 로직에 손대지 않음

## 3.4 Forward Test (FT)
목적

실전 환경과 동일한 조건에서 전략을 테스트하는 단계

최신 시장 환경에서 전략이 여전히 살아있는지 검증

테스트 방식

RiskManager FULL 적용

거래당 리스크(예: 1%)

계좌 전체 리스크 제한(예: 5%)

최대 보유종목 수 제한

슬리피지/수수료 반영

실전 체결 로직과 동일하게 시뮬레이션

통과 기준

실전 조건에서도 전략 성능이 유지될 것

포지션 구성/리스크 구조에 문제가 없을 것

요약

✔ 실전 모의고사
✔ 실전 실행 시스템과 거의 동일하게 테스트

# 4. 데이터(Timeframe) 관련 가정

현재 단계에서는 일봉(1D) 데이터만 사용한다.

멀티 타임프레임(분봉/주봉/월봉)을 사용할 경우에도
백테스트 엔진은 그대로 두고,
전략이 필요한 타임프레임을 선언하는 방식으로 확장 가능하다.

# 5. 전체 흐름 요약
[전략 정의]
        ↓
[In-sample Test]
        ↓ (과적합 방지 검증)
[Out-of-sample Test]
        ↓ (실전 조건 평가)
[Forward Test]

# 6. 마지막 요약

IS = 전략 성능 확인 및 튜닝

OOS = 과적합 여부 검증

FT = 실전 동일 조건 테스트